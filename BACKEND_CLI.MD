Plan de ImplementaciÃ³n: AvangCLI Backend - Comando init

1. ARQUITECTURA DEL PROYECTO CLI
Estructura de Directorios Propuesta
backend-cli/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ avangcli/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ cli.py                    # Entry point principal
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ init.py               # Comando init
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ validators.py         # Validaciones de dependencias
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py             # Configuraciones globales
â”‚   â”‚   â”‚   â””â”€â”€ exceptions.py         # Excepciones personalizadas
â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts.py            # LÃ³gica de preguntas interactivas
â”‚   â”‚   â”‚   â”œâ”€â”€ messages.py           # Mensajes y textos de UI
â”‚   â”‚   â”‚   â””â”€â”€ widgets.py            # Widgets personalizados (Textual)
â”‚   â”‚   â”œâ”€â”€ generators/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ project.py            # Generador principal de proyecto
â”‚   â”‚   â”‚   â”œâ”€â”€ docker.py             # Generador de archivos Docker
â”‚   â”‚   â”‚   â”œâ”€â”€ config_files.py       # Generador de configs (pyproject, etc)
â”‚   â”‚   â”‚   â””â”€â”€ makefile.py           # Generador de Makefile
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ project_config.py     # Modelo de configuraciÃ³n del proyecto
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â”œâ”€â”€ project_structure/
â”‚   â”‚       â”‚   â”œâ”€â”€ basic/            # Template bÃ¡sico sin DB
â”‚   â”‚       â”‚   â””â”€â”€ with_db/          # Template con DB
â”‚   â”‚       â”œâ”€â”€ docker/
â”‚   â”‚       â”‚   â”œâ”€â”€ docker-compose.dev.yml.jinja
â”‚   â”‚       â”‚   â”œâ”€â”€ docker-compose.prod.yml.jinja
â”‚   â”‚       â”‚   â””â”€â”€ Dockerfile.jinja
â”‚   â”‚       â”œâ”€â”€ config/
â”‚   â”‚       â”‚   â”œâ”€â”€ pyproject.toml.jinja
â”‚   â”‚       â”‚   â”œâ”€â”€ ruff.toml.jinja
â”‚   â”‚       â”‚   â””â”€â”€ .env.example.jinja
â”‚   â”‚       â””â”€â”€ makefile/
â”‚   â”‚           â””â”€â”€ Makefile.jinja
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ fixtures/
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md
Patrones de DiseÃ±o a Implementar
Builder Pattern: Para construir la configuraciÃ³n del proyecto paso a paso
Strategy Pattern: Para diferentes estrategias de generaciÃ³n segÃºn selecciones
Template Method: Para el flujo comÃºn de generaciÃ³n con hooks personalizables
Factory Pattern: Para crear generadores especÃ­ficos segÃºn configuraciÃ³n
2. FASES DE IMPLEMENTACIÃ“N
FASE 1: ConfiguraciÃ³n Base y Estructura del Proyecto âœ… COMPLETADA
Prioridad: Alta
DuraciÃ³n estimada: 1-2 dÃ­as
Commit: c07e12b - chore(backend-cli): directory structure and basic CLI setup

Tareas:
âœ… Crear estructura de directorios del proyecto CLI
âœ… Configurar pyproject.toml con UV como gestor de paquetes
âœ… Instalar y configurar dependencias: Typer (CLI framework), Textual (UI), Jinja2 (templates)
âœ… Crear entry point principal en cli.py con Typer
âœ… Implementar comando bÃ¡sico avangcli --version y avangcli --help
âœ… Configurar sistema de logging para debugging

Entregables:
âœ… Proyecto CLI funcional con estructura base
âœ… Sistema de comandos configurado con Typer
âœ… DocumentaciÃ³n de arquitectura inicial (README.md)

Dependencias:
Ninguna (fase inicial)
FASE 2: Sistema de Validaciones y Utilidades Core
Prioridad: Alta
DuraciÃ³n estimada: 1 dÃ­a Tareas:
 Implementar validador de dependencias del sistema en validators.py
Verificar si Poetry estÃ¡ instalado (poetry --version)
Verificar si UV estÃ¡ instalado (uv --version)
Verificar si Docker estÃ¡ instalado y corriendo (docker --version, docker ps)
Verificar si Git estÃ¡ instalado (git --version)
 Crear excepciones personalizadas en exceptions.py
DependencyNotFoundError
InvalidProjectNameError
ProjectAlreadyExistsError
 Implementar modelo ProjectConfig en models/project_config.py usando Pydantic
Atributos: name, package_manager, use_database, db_environments, linter_formatter, use_git, use_makefile
 Crear utilidades de validaciÃ³n de nombres de proyecto (formato vÃ¡lido Python)
Entregables:
Sistema de validaciones robusto
Modelo de configuraciÃ³n del proyecto
Excepciones tipadas y documentadas
Dependencias:
FASE 1 completada
FASE 3: Sistema de UI Interactiva
Prioridad: Alta
DuraciÃ³n estimada: 2-3 dÃ­as Tareas:
 Implementar prompts interactivos en ui/prompts.py usando Textual
Prompt de texto para nombre del proyecto con validaciÃ³n en tiempo real
Prompt de selecciÃ³n Ãºnica para package manager (Poetry/UV)
Prompt Yes/No para configuraciÃ³n de base de datos
Prompt de selecciÃ³n mÃºltiple para entornos Docker (dev/prod/both/none)
Prompt de selecciÃ³n mÃºltiple para linter/formatter (Ruff/Black/Flake8/None)
Prompt Yes/No para inicializar Git
Prompt Yes/No para generar Makefile
 Crear widgets personalizados si es necesario en ui/widgets.py
 Implementar mensajes estandarizados en ui/messages.py
Mensajes de Ã©xito (con Rich)
Mensajes de error (con Rich)
Mensajes de advertencia
Mensajes informativos durante el proceso
 Implementar sistema de navegaciÃ³n entre preguntas (siguiente/anterior)
 AÃ±adir resumen de configuraciÃ³n antes de generar proyecto
Entregables:
Sistema de prompts completamente funcional
UI consistente y profesional
Flujo de navegaciÃ³n intuitivo
Dependencias:
FASE 2 completada
FASE 4: Sistema de Templates
Prioridad: Alta
DuraciÃ³n estimada: 2-3 dÃ­as Tareas:
 Crear template de estructura de proyecto FastAPI siguiendo Screaming Architecture
app/main.py - Entry point de FastAPI
app/core/ - ConfiguraciÃ³n, dependencias, seguridad
app/api/ - Endpoints organizados por dominio
app/domain/ - Modelos de dominio y lÃ³gica de negocio
app/infrastructure/ - Implementaciones de persistencia, servicios externos
app/tests/ - Tests organizados por capas
 Crear templates Jinja2 para archivos de configuraciÃ³n
pyproject.toml.jinja con secciones condicionales segÃºn package manager
ruff.toml.jinja o .black segÃºn selecciÃ³n
.env.example.jinja con variables segÃºn configuraciÃ³n
.gitignore estÃ¡ndar para Python/FastAPI
 Crear templates Docker
Dockerfile.jinja optimizado para FastAPI
docker-compose.dev.yml.jinja con servicios de DB condicionales
docker-compose.prod.yml.jinja con configuraciÃ³n de producciÃ³n
 Crear template de Makefile con comandos dinÃ¡micos segÃºn configuraciÃ³n
Comandos de instalaciÃ³n segÃºn package manager
Comandos de linting segÃºn herramienta seleccionada
Comandos de Docker si aplica
Comandos de testing
 Implementar sistema de renderizado de templates con variables de contexto
Entregables:
Conjunto completo de templates Jinja2
Sistema de renderizado de templates
Templates probados con diferentes configuraciones
Dependencias:
FASE 2 completada
FASE 5: Generadores de Proyecto
Prioridad: Alta
DuraciÃ³n estimada: 2-3 dÃ­as Tareas:
 Implementar ProjectGenerator en generators/project.py
MÃ©todo para crear estructura de directorios
MÃ©todo para copiar y renderizar templates
MÃ©todo para ejecutar post-processing (git init, etc)
 Implementar DockerGenerator en generators/docker.py
Generar archivos Docker segÃºn configuraciÃ³n
Validar sintaxis de archivos generados
 Implementar ConfigFilesGenerator en generators/config_files.py
Generar pyproject.toml segÃºn package manager
Generar configuraciÃ³n de linters
Generar .env.example
 Implementar MakefileGenerator en generators/makefile.py
Generar comandos segÃºn herramientas seleccionadas
Validar sintaxis de Makefile
 Implementar orquestador de generadores que coordine la creaciÃ³n completa
Entregables:
Sistema de generadores modular y testeable
Proyectos generados correctamente segÃºn configuraciÃ³n
Validaciones de archivos generados
Dependencias:
FASE 4 completada
FASE 6: IntegraciÃ³n del Comando Init
Prioridad: Alta
DuraciÃ³n estimada: 1-2 dÃ­as Tareas:
 Implementar comando init en commands/init.py
Integrar flujo de prompts de FASE 3
Ejecutar validaciones de FASE 2
Invocar generadores de FASE 5
Manejar errores y mostrar mensajes apropiados
 Implementar validaciÃ³n pre-generaciÃ³n
Verificar que directorio no exista
Verificar dependencias necesarias instaladas
Confirmar con usuario antes de generar
 Implementar post-generaciÃ³n
Inicializar Git si seleccionado
Ejecutar poetry install o uv sync segÃºn selecciÃ³n
Mostrar mensaje de Ã©xito con prÃ³ximos pasos
 AÃ±adir flag --dry-run para ver quÃ© se generarÃ­a sin crear archivos
 AÃ±adir opciÃ³n de configuraciÃ³n desde archivo JSON/YAML para CI/CD
Entregables:
Comando avangcli init completamente funcional
Modo dry-run implementado
Soporte para configuraciÃ³n no interactiva
Dependencias:
FASE 3, 4, 5 completadas
FASE 7: Testing y DocumentaciÃ³n
Prioridad: Media
DuraciÃ³n estimada: 2-3 dÃ­as Tareas:
 Escribir tests unitarios para validadores
 Escribir tests unitarios para generadores
 Escribir tests de integraciÃ³n para flujo completo de init
 Crear fixtures de proyectos de ejemplo
 Documentar cada mÃ³dulo con docstrings
 Crear README.md con guÃ­a de uso
 Crear CONTRIBUTING.md con guÃ­a de desarrollo
 AÃ±adir ejemplos de uso en documentaciÃ³n
Entregables:
Cobertura de tests >80%
DocumentaciÃ³n completa y clara
Ejemplos funcionales
Dependencias:
Todas las fases anteriores completadas
FASE 8: Pulido y Mejoras de UX
Prioridad: Media-Baja
DuraciÃ³n estimada: 1-2 dÃ­as Tareas:
 AÃ±adir barra de progreso durante generaciÃ³n de proyecto
 Mejorar mensajes de error con sugerencias de soluciÃ³n
 AÃ±adir animaciones de carga para operaciones largas
 Implementar sistema de configuraciÃ³n global (~/.avangcli/config)
 AÃ±adir comando para guardar templates personalizados
 Implementar telemetrÃ­a opcional (con opt-in explÃ­cito)
 AÃ±adir comando de actualizaciÃ³n de templates
Entregables:
UX pulida y profesional
Sistema de configuraciÃ³n persistente
Capacidad de extensiÃ³n con templates custom
Dependencias:
FASE 7 completada
3. ESTRUCTURA DE TEMPLATES
Template: Proyecto BÃ¡sico (sin DB)
UbicaciÃ³n: templates/project_structure/basic/ Estructura de directorios generada:
{project_name}/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â””â”€â”€ dependencies.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ health.py
â”‚   â””â”€â”€ domain/
â”‚       â””â”€â”€ __init__.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_main.py
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ Makefile (opcional)
Variables de template:
{{ project_name }}: Nombre del proyecto
{{ package_manager }}: "poetry" o "uv"
{{ python_version }}: "3.11" (por defecto, podrÃ­a hacerse configurable)
{{ linters }}: Lista de linters seleccionados
{{ use_git }}: Boolean
{{ use_makefile }}: Boolean
Template: Proyecto con Base de Datos
UbicaciÃ³n: templates/project_structure/with_db/ Estructura adicional:
{project_name}/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ database.py
â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”‚       â””â”€â”€ __init__.py
â”‚   â””â”€â”€ domain/
â”‚       â”œâ”€â”€ models/
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â””â”€â”€ repositories/
â”‚           â””â”€â”€ __init__.py
â”œâ”€â”€ alembic/
â”‚   â”œâ”€â”€ versions/
â”‚   â””â”€â”€ env.py
â”œâ”€â”€ docker-compose.dev.yml (opcional)
â”œâ”€â”€ docker-compose.prod.yml (opcional)
â””â”€â”€ Dockerfile (opcional)
Variables adicionales:
{{ db_type }}: "postgresql" (por defecto, extensible a MySQL, etc)
{{ db_environments }}: ["dev", "prod"] o subset
{{ use_docker }}: Boolean derivado de db_environments
Template: pyproject.toml
UbicaciÃ³n: templates/config/pyproject.toml.jinja Secciones condicionales:
[project]
name = "{{ project_name }}"
version = "0.1.0"
description = ""
requires-python = ">={{ python_version }}"

dependencies = [
    "fastapi>=0.104.0",
    "uvicorn[standard]>=0.24.0",
    {% if use_database %}
    "sqlalchemy>=2.0.0",
    "alembic>=1.12.0",
    "asyncpg>=0.29.0",  # Para PostgreSQL
    {% endif %}
    "pydantic>=2.4.0",
    "pydantic-settings>=2.0.0",
]

{% if package_manager == "uv" %}
[tool.uv]
dev-dependencies = [
    "pytest>=7.4.0",
    "httpx>=0.25.0",
    {% if "ruff" in linters %}
    "ruff>=0.1.0",
    {% endif %}
    {% if "black" in linters %}
    "black>=23.10.0",
    {% endif %}
]
{% endif %}

{% if package_manager == "poetry" %}
[tool.poetry.dependencies]
python = "^{{ python_version }}"

# ... dependencias listadas arriba

[tool.poetry.group.dev.dependencies]
pytest = "^7.4.0"

# ... dev dependencies

{% endif %}

{% if "ruff" in linters %}
[tool.ruff]
line-length = 100
target-version = "py{{ python_version.replace('.', '') }}"
{% endif %}

{% if "black" in linters %}
[tool.black]
line-length = 100
target-version = ['py{{ python_version.replace('.', '') }}']
{% endif %}
Template: Makefile
UbicaciÃ³n: templates/makefile/Makefile.jinja Comandos generados dinÃ¡micamente:
.PHONY: install dev test lint format clean

install:
{% if package_manager == "poetry" %}
 poetry install
{% elif package_manager == "uv" %}
 uv sync
{% endif %}

dev:
{% if use_database and "dev" in db_environments %}
 docker-compose -f docker-compose.dev.yml up -d
{% endif %}
{% if package_manager == "poetry" %}
 poetry run uvicorn app.main:app --reload
{% elif package_manager == "uv" %}
 uv run uvicorn app.main:app --reload
{% endif %}

test:
{% if package_manager == "poetry" %}
 poetry run pytest
{% elif package_manager == "uv" %}
 uv run pytest
{% endif %}

{% if "ruff" in linters %}
lint:
 ruff check .

format:
 ruff format .
{% elif "black" in linters %}
format:
 black .
{% endif %}

{% if use_database %}
db-migrate:
 alembic upgrade head

db-revision:
 alembic revision --autogenerate -m "$(msg)"
{% endif %}

clean:
 find . -type d -name __pycache__ -exec rm -rf {} +
 find . -type f -name "*.pyc" -delete
{% if use_database and "dev" in db_environments %}
 docker-compose -f docker-compose.dev.yml down -v
{% endif %}
Template: Docker Compose (Desarrollo)
UbicaciÃ³n: templates/docker/docker-compose.dev.yml.jinja
version: '3.8'

services:
  {% if use_database %}
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: {{ project_name }}_user
      POSTGRES_PASSWORD: dev_password
      POSTGRES_DB: {{ project_name }}_db
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  {% endif %}
  api:
    build:
      context: .
      dockerfile: Dockerfile
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    ports:
      - "8000:8000"
    volumes:
      - .:/app
    {% if use_database %}
    depends_on:
      - db
    environment:
      DATABASE_URL: postgresql://{{ project_name }}_user:dev_password@db:5432/{{ project_name }}_db
    {% endif %}

{% if use_database %}
volumes:
  postgres_data:
{% endif %}
4. FLUJO DE INTERACCIÃ“N CON USUARIO
Diagrama de Flujo
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  avangcli init                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bienvenida + Banner ASCII              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 1: Nombre del Proyecto        â”‚
â”‚  - ValidaciÃ³n: Formato Python vÃ¡lido    â”‚
â”‚  - ValidaciÃ³n: Directorio no existe     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 2: Package Manager            â”‚
â”‚  â—‹ UV (recomendado)                     â”‚
â”‚  â—‹ Poetry                               â”‚
â”‚  â†’ Validar instalaciÃ³n                  â”‚
â”‚  â†’ Si no estÃ¡: Error + instrucciones    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 3: Â¿Configurar DB?            â”‚
â”‚  â—‹ SÃ­  â—‹ No                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€â”€â”€ No â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                           â”‚
               â””â”€â”€â”€ SÃ­ â”€â”€â”€â”                â”‚
                          â–¼                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
            â”‚  Pregunta 3a:        â”‚       â”‚
            â”‚  Entornos Docker:    â”‚       â”‚
            â”‚  â˜‘ Desarrollo        â”‚       â”‚
            â”‚  â˜‘ ProducciÃ³n        â”‚       â”‚
            â”‚  â˜ Ninguno           â”‚       â”‚
            â”‚  â†’ Validar Docker    â”‚       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                       â”‚                   â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                           â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 4: Linter/Formatter           â”‚
â”‚  â˜‘ Ruff (recomendado)                   â”‚
â”‚  â˜ Black                                â”‚
â”‚  â˜ Flake8                               â”‚
â”‚  â˜ Ninguno                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 5: Â¿Inicializar Git?          â”‚
â”‚  â—‹ SÃ­  â—‹ No                             â”‚
â”‚  â†’ Validar Git instalado                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pregunta 6: Â¿Generar Makefile?         â”‚
â”‚  â—‹ SÃ­  â—‹ No                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Resumen de ConfiguraciÃ³n               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Proyecto: my_api                  â”‚  â”‚
â”‚  â”‚ Package Manager: UV               â”‚  â”‚
â”‚  â”‚ Base de Datos: SÃ­ (Dev + Prod)    â”‚  â”‚
â”‚  â”‚ Linter: Ruff                      â”‚  â”‚
â”‚  â”‚ Git: SÃ­                           â”‚  â”‚
â”‚  â”‚ Makefile: SÃ­                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Â¿Continuar? [S/n]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”œâ”€â”€â”€ No â”€â†’ Cancelar
               â”‚
               â””â”€â”€â”€ SÃ­ â”€â”€â”€â”
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  GeneraciÃ³n Proyecto â”‚
            â”‚  [Barra de progreso] â”‚
            â”‚  âœ“ Estructura        â”‚
            â”‚  âœ“ Templates         â”‚
            â”‚  âœ“ ConfiguraciÃ³n     â”‚
            â”‚  âœ“ Git init          â”‚
            â”‚  âœ“ InstalaciÃ³n deps  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Â¡Ã‰xito! ğŸ‰          â”‚
            â”‚  PrÃ³ximos pasos:     â”‚
            â”‚  1. cd my_api        â”‚
            â”‚  2. make dev         â”‚
            â”‚  3. ...              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Validaciones por Paso
Paso 1 - Nombre del Proyecto:
Formato vÃ¡lido Python (snake_case preferido)
No contiene caracteres especiales excepto_
No es una palabra reservada de Python
El directorio no existe ya
No estÃ¡ vacÃ­o
Paso 2 - Package Manager:
Si selecciona UV: ejecutar uv --version
Si selecciona Poetry: ejecutar poetry --version
Si falla: mostrar error con instrucciones de instalaciÃ³n
Permitir continuar sin instalaciÃ³n (modo dry-run)
Paso 3 - Base de Datos:
Si selecciona "SÃ­" y luego selecciona entornos Docker:
Validar docker --version
Validar docker ps (daemon corriendo)
Si falla: advertir pero permitir continuar (generarÃ¡ archivos Docker)
Paso 4 - Linters:
SelecciÃ³n mÃºltiple permitida
Si selecciona Ruff + Black: advertir sobre posible conflicto
Permitir "Ninguno"
Paso 5 - Git:
Si selecciona "SÃ­": validar git --version
Si falla: advertir pero permitir continuar
Paso 6 - Makefile:
Sin validaciones especiales
Contenido depende de selecciones anteriores
Manejo de Errores
Errores Recuperables (advertencias):
Docker no instalado pero se seleccionÃ³ DB â†’ Generar archivos, advertir instalaciÃ³n
Git no instalado pero se seleccionÃ³ inicializar â†’ Generar .gitignore, advertir
Errores Fatales (bloquean generaciÃ³n):
Nombre de proyecto invÃ¡lido
Directorio ya existe
Package manager seleccionado no instalado (sin modo dry-run)
Error al crear directorio (permisos)
Error al escribir archivos
Mensajes de Error - Ejemplos:
âŒ Error: El directorio 'my_api' ya existe
ğŸ’¡ Sugerencia: Usa otro nombre o elimina el directorio existente

âš ï¸  Advertencia: Docker no estÃ¡ instalado
ğŸ“‹ Se generarÃ¡n los archivos Docker pero no podrÃ¡s ejecutarlos
   Instala Docker: <https://docs.docker.com/get-docker/>
5. CONSIDERACIONES TÃ‰CNICAS
Decisiones ArquitectÃ³nicas Clave
CLI Framework: Typer
RazÃ³n: Built on Click, type hints nativos, auto-documentaciÃ³n
Alternativa considerada: Click (mÃ¡s bajo nivel), Argparse (menos features)
UI Framework: Textual (con Rich integrado)
RazÃ³n: Textual incluye Rich, permite UIs mÃ¡s complejas futuras (TUI)
Rich solo para formateo de mensajes y tablas
Alternativa: inquirer/questionary (menos potente para futuro)
Templates: Jinja2
RazÃ³n: EstÃ¡ndar de facto, sintaxis poderosa, bien documentado
Alternativa: Mako, Chevron (menos conocidos)
ValidaciÃ³n: Pydantic
RazÃ³n: ValidaciÃ³n robusta, type hints, integraciÃ³n FastAPI
Para modelo ProjectConfig y validaciÃ³n de inputs
Testing: Pytest
Con pytest-mock para mocking de filesystem
pytest-cov para cobertura
LibrerÃ­as EspecÃ­ficas de Textual/Rich
De Textual:
textual.widgets.Input: Para input de texto (nombre proyecto)
textual.widgets.Select: Para selecciÃ³n Ãºnica (package manager)
textual.widgets.Checkbox: Para selecciÃ³n mÃºltiple (linters, entornos)
textual.widgets.Button: Para confirmaciÃ³n
textual.app.App: Para flujo de aplicaciÃ³n
De Rich (integrado en Textual):
rich.console.Console: Para output colorido
rich.progress.Progress: Para barra de progreso
rich.panel.Panel: Para resumen de configuraciÃ³n
rich.table.Table: Para mostrar opciones
rich.markdown.Markdown: Para formatear mensajes
Estrategias de Testing
Tests Unitarios:

# tests/unit/test_validators.py

def test_validate_project_name_valid():
    assert validate_project_name("my_project") == True

def test_validate_project_name_invalid_characters():
    with pytest.raises(InvalidProjectNameError):
        validate_project_name("my-project")

# tests/unit/test_generators.py

def test_project_generator_creates_structure(tmp_path):
    config = ProjectConfig(name="test_project", ...)
    generator = ProjectGenerator(config)
    generator.generate(tmp_path)

    assert (tmp_path / "test_project" / "app" / "main.py").exists()
Tests de IntegraciÃ³n:

# tests/integration/test_init_command.py

def test_init_command_full_flow(tmp_path, monkeypatch):
    # Mock de prompts para simular inputs usuario
    # Verificar proyecto completo generado correctamente
    pass
Tests de Templates:

# tests/test_templates.py

def test_pyproject_template_poetry():
    context = {"package_manager": "poetry", ...}
    rendered = render_template("pyproject.toml.jinja", context)

    assert "[tool.poetry]" in rendered
    assert "[tool.uv]" not in rendered
GestiÃ³n de Dependencias del Sistema
Estrategia de VerificaciÃ³n:

# core/validators.py

class DependencyValidator:
    @staticmethod
    def check_command(command: str, args: list[str] = ["--version"]) -> bool:
        """Verifica si un comando estÃ¡ disponible en el sistema"""
        try:
            result = subprocess.run(
                [command, *args],
                capture_output=True,
                text=True,
                timeout=5
            )
            return result.returncode == 0
        except (subprocess.TimeoutExpired, FileNotFoundError):
            return False

    def validate_package_manager(self, manager: str) -> None:
        if not self.check_command(manager):
            raise DependencyNotFoundError(
                f"{manager} no estÃ¡ instalado",
                suggestion=f"Instala {manager}: [link a docs]"
            )
6. PRÃ“XIMOS PASOS Y AJUSTES NECESARIOS
Puntos que Requieren ClarificaciÃ³n
VersiÃ³n de Python por defecto
Â¿Fijar en 3.11+ o preguntar al usuario?
Sugerencia: Fijar en 3.11 inicialmente, hacer configurable en v2
Base de datos por defecto
Â¿Solo PostgreSQL o soportar MySQL/SQLite desde inicio?
Sugerencia: Solo PostgreSQL en v1, extensible despuÃ©s
Estructura de Screaming Architecture
Â¿Incluir carpetas use_cases o simplificar?
Sugerencia: Revisar documentaciÃ³n oficial de FastAPI para confirmar estructura exacta
AutenticaciÃ³n/AutorizaciÃ³n
Â¿Incluir template con auth bÃ¡sico (JWT)?
Sugerencia: FASE 9 futura - avangcli add auth
Testing frameworks adicionales
Â¿Soportar unittest ademÃ¡s de pytest?
Sugerencia: Solo pytest en v1
Decisiones Pendientes
Nombrado del proyecto generado
Â¿Usar snake_case forzosamente o permitir kebab-case?
DecisiÃ³n recomendada: Forzar snake_case, convertir automÃ¡ticamente
Manejo de conflictos en generaciÃ³n
Â¿QuÃ© hacer si el directorio existe pero estÃ¡ vacÃ­o?
DecisiÃ³n recomendada: Permitir con flag --force, preguntar por defecto
ConfiguraciÃ³n de pre-commit hooks
Â¿Incluir pre-commit con hooks automÃ¡ticos?
DecisiÃ³n recomendada: SÃ­, configurar segÃºn linters seleccionados
Soporte para monorepo
Â¿Permitir generar proyecto dentro de monorepo existente?
DecisiÃ³n recomendada: FASE futura, no en v1
InternacionalizaciÃ³n
Â¿Soportar mensajes en espaÃ±ol e inglÃ©s?
DecisiÃ³n recomendada: InglÃ©s por defecto, espaÃ±ol en v2 si hay demanda
Sugerencias de Mejora
Comando complementario: avangcli add
avangcli add auth - AÃ±adir autenticaciÃ³n a proyecto existente
avangcli add crud <model> - Generar CRUD para un modelo
Prioridad: Post-v1
Templates de ejemplo
Incluir carpeta examples/ con proyectos de ejemplo generados
Ãštil para testing y documentaciÃ³n
ValidaciÃ³n de estructura post-generaciÃ³n
Comando avangcli check que valide que el proyecto sigue estructura correcta
Ãštil despuÃ©s de modificaciones manuales
IntegraciÃ³n con IDE
Generar .vscode/settings.json con configuraciÃ³n de linters
Generar configuraciÃ³n para PyCharm
Sistema de plugins
Permitir templates de terceros
Formato: avangcli init --template @user/template-name
Prioridad: v2 o v3
TelemetrÃ­a y analytics
Recopilar estadÃ­sticas de uso (opt-in)
Entender quÃ© configuraciones son mÃ¡s populares
Requiere consideraciones de privacidad
Riesgos Identificados
Complejidad de Textual
Riesgo: Curva de aprendizaje alta
MitigaciÃ³n: Empezar con ejemplos simples, documentaciÃ³n oficial
Mantenimiento de templates
Riesgo: Templates desactualizados con nuevas versiones de FastAPI
MitigaciÃ³n: Tests de integraciÃ³n que generen y corran proyectos
Compatibilidad entre package managers
Riesgo: Diferencias sutiles entre Poetry y UV
MitigaciÃ³n: Tests especÃ­ficos para cada manager
Experiencia en Windows
Riesgo: Comandos shell especÃ­ficos de Unix
MitigaciÃ³n: Usar pathlib en lugar de rutas hardcodeadas, probar en WSL
Timeline Estimado Total
FASE 1-6 (Core functionality): 10-15 dÃ­as
FASE 7 (Testing): 2-3 dÃ­as
FASE 8 (Polish): 1-2 dÃ­as
Total MVP: 13-20 dÃ­as de desarrollo
MÃ©tricas de Ã‰xito
Proyecto generado compila sin errores
Tests del proyecto generado pasan
Docker compose levanta correctamente (si aplica)
Comandos de Makefile funcionan
Linters configurados corren sin errores
Tiempo de generaciÃ³n < 30 segundos (sin instalaciÃ³n de deps)
UX intuitiva (feedback de usuarios beta)
